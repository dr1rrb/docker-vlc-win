# VLC in a Windows container
Run the [VLC](https://www.videolan.org/) on a Windows container host.

[![Build Status](https://dev.azure.com/dr1rrb/docker-vlc-win/_apis/build/status/dr1rrb.docker-vlc-win?branchName=master)](https://dev.azure.com/dr1rrb/docker-vlc-win/_build/latest?definitionId=1&branchName=master)

## Configuration
### Network
_none_

### Volumes
_none_

## Run the container
### Command line
```
docker run -d dr1rrb/vlc-win
```

### Docker compose
Suggested docker compose file (for a network camera recording)

_**About path escapping**: the provided path are escapped once for YAML, a second time for the "CMD" 
generated by Docker, and third for VLC. So you have to put 4 `\` to get single `\` in the final path, 
and 16 `\` to get a double for a network share / domain DFS (i.e. ` \\\\ ` => ` \ ` and `\\\\\\\\\\\\\\\\` => `\\`)._

```
version: '3.4'
services:
  locker:
    container_name: locker
    image: dr1rrb/vlc-win:2.2.8 # Use the specific version 2.2.8 as the ":run-time 300" is ignored on latest 3.0.7.1 and 3.0.6
    restart: unless-stopped
    ports:
      - 9001:8000
    security_opt: 
      - "credentialspec=file://torick_monitoring.json" # Network identity, cf. TIPS below
    hostname: monitoring_locker
    command: "rtsp://[username]:[password]@[camera01_hostname]:554/play1.sdp :sout=#file{dst=\\\\\\\\\\\\\\\\[network_share]\\\\Monitoring\\\\Camera01\\\\%Y-%m-%d-%H-%M.mp4,no-overwrite} :sout-all :no-sout-keep :run-time=300 --loop --sout-file-format --intf=http --http-password=**** --http-host=0.0.0.0 --http-port=8000"
  
  living:
    container_name: living
    image: dr1rrb/vlc-win:2.2.8
    restart: unless-stopped
    ports:
      - 9002:8000
    security_opt: 
      - "credentialspec=file://torick_monitoring.json"
    hostname: monitoring_living
    command: "rtsp://[username]:[password]@[camera02_hostname]:554/play1.sdp :sout=#file{dst=\\\\\\\\\\\\\\\\[network_share]\\\\Monitoring\\\\Camera02\\\\%Y-%m-%d-%H-%M.mp4,no-overwrite} :sout-all :no-sout-keep :run-time=300 --loop --sout-file-format --intf=http --http-password=**** --http-host=0.0.0.0 --http-port=8000"
```

## TIPS: Running a Windows container on a AD joined host
Usually when running a Windows container, we need it to integrates with other servers and network infrastructure.
If you have an active directory (AD), it's pretty easy to give a valid network identity to your container.
You can find more info [here](https://docs.microsoft.com/en-us/virtualization/windowscontainers/manage-containers/manage-serviceaccounts)
and [here](https://artisticcheese.wordpress.com/2017/09/09/enabling-integrated-windows-authentication-in-windows-docker-container/).
